<!DOCTYPE html>
<html lang="tr" data-theme="dark" class="intro-on">
<head>
  <meta charset="UTF-8" />
  <title>KÄ±ble Bulucu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- MathJax (formÃ¼ller iÃ§in) -->
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <!-- Font Awesome (ikonlar) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Uygulama stilleri -->
  <link rel="stylesheet" href="css/style.css" />

  <!-- Uygulama JS -->
  <script defer src="js/main.js"></script>

  <!-- Backend canlÄ±lÄ±k pingâ€™i (opsiyonel) -->
  <script>
    fetch("https://api.bur4kkaplan.com/api/ping")
      .then(res => console.log("Backend ping atÄ±ldÄ±:", res.status))
      .catch(err => console.error("Backend uyanamadÄ±:", err));
  </script>
</head>
<body>

  <!-- Tema geÃ§iÅŸ overlay (JS ile tetiklenir) -->
  <div id="theme-wipe" aria-hidden="true"></div>

  <!-- ========== WELCOME SCREEN (MOBÄ°L) ========== -->
  <section id="welcome-screen" class="welcome">

    <!-- Ãœst bar: dark toggle (sol) + dil (saÄŸ) -->
    <div class="welcome-top">
      <button id="theme-toggle" class="theme-toggle" aria-label="Tema deÄŸiÅŸtir" aria-pressed="true" title="KaranlÄ±k/AÃ§Ä±k Mod">
        <span class="icon-sun" aria-hidden="true">â˜€ï¸</span>
        <span class="icon-moon" aria-hidden="true">ğŸŒ™</span>
      </button>

      <div class="lang-group" role="tablist" aria-label="Dil seÃ§imi">
        <button id="btn-lang-tr" class="flag-btn is-active" role="tab" aria-selected="true" title="TÃ¼rkÃ§e">
          <img src="img/tr.svg" alt="TÃ¼rkÃ§e" width="28" height="28" />
        </button>
        <button id="btn-lang-en" class="flag-btn" role="tab" aria-selected="false" title="English">
          <img src="img/eng.svg" alt="English" width="28" height="28" />
        </button>
      </div>
    </div>

    <!-- Ãœst motif (saÄŸaâ†’sola) -->
    <div class="motif-strip motif-top" aria-hidden="true"></div>

    <!-- Kahraman iÃ§erik -->
    <div id="welcome-content" class="welcome-hero">
      <div id="welcome-overline" class="overline">Burak Kaplanâ€™dan</div>
      <h1 class="title-stack wipe-in" aria-live="polite">
        <span id="title-top">KÄ±ble Bulucuâ€™ya</span>
        <span id="title-bottom">HoÅŸ Geldiniz</span>
      </h1>
      <button id="welcome-cta" class="cta-btn">
        <span id="welcome-cta-text">BaÅŸlayalÄ±m</span>
        <i class="fa-solid fa-arrow-right-long" aria-hidden="true"></i>
      </button>
    </div>

    <!-- Alt motif (solaâ†’saÄŸa) -->
    <div class="motif-strip motif-bottom" aria-hidden="true"></div>

    <!-- Sosyal -->
    <div class="welcome-social">
      <a class="s-link" href="https://www.linkedin.com/in/bur4kkaplan/" target="_blank" rel="noopener" aria-label="LinkedIn" title="LinkedIn">
        <i class="fab fa-linkedin"></i>
      </a>

      <!-- GitHub: inline SVG â€œmarkâ€ -->
      <a class="s-link" href="https://github.com/bur4kkaplan" target="_blank" rel="noopener" aria-label="GitHub" title="GitHub">
        <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
          <path fill="currentColor"
            d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.438 9.8 8.205 11.387.6.11.82-.26.82-.577 0-.285-.01-1.04-.015-2.04-3.338.726-4.042-1.61-4.042-1.61-.546-1.387-1.335-1.757-1.335-1.757-1.09-.746.083-.73.083-.73 1.204.085 1.838 1.237 1.838 1.237 1.07 1.835 2.807 1.305 3.492.998.108-.776.42-1.305.763-1.605-2.665-.305-5.466-1.33-5.466-5.93 0-1.31.467-2.382 1.236-3.222-.124-.303-.536-1.524.117-3.176 0 0 1.008-.322 3.3 1.23a11.5 11.5 0 0 1 6 0C17.4 3.37 18.41 3.693 18.41 3.693c.653 1.652.241 2.873.117 3.176.77.84 1.235 1.912 1.235 3.222 0 4.61-2.804 5.624-5.475 5.922.431.372.815 1.102.815 2.222 0 1.604-.015 2.894-.015 3.287 0 .319.218.694.825.576C20.565 21.796 24 17.298 24 12 24 5.37 18.63 0 12 0z"/>
        </svg>
      </a>

      <a class="s-link" href="https://x.com/bur4kkaplan" target="_blank" rel="noopener" aria-label="X (Twitter)" title="X (Twitter)">
        <svg class="icon-x" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
          <path fill="currentColor"
            d="M18.244 2.25h3.113l-6.79 7.72 7.996 11.78h-6.277l-4.923-6.42-5.62 6.42H2.63l7.332-8.39L2.25 2.25h6.4l4.473 5.88 5.121-5.88Zm-1.09 17.36h1.726L7.16 3.653H5.32L17.154 19.61Z"/>
        </svg>
      </a>
    </div>

    <!-- ArtÄ±k DÃœZ YAZI; link deÄŸil -->
    <div class="social-handle">/bur4kkaplan</div>

  </section>
  <!-- ========== /WELCOME ========== -->

  <!-- ========== HOW-IT-WORKS ========== -->
  <section id="howit-screen" class="welcome" style="display:none;" aria-labelledby="howit-title">
    <div class="welcome-top">
      <button id="howit-back" class="theme-toggle" aria-label="Geri" title="Geri">
        <i class="fa-solid fa-arrow-left" aria-hidden="true"></i>
      </button>
      <div style="width:42px;height:42px;"></div>
    </div>

    <div id="howit-content" class="welcome-hero">
      <h1 id="howit-title" class="title" style="margin-top:0;">Uygulama NasÄ±l Ã‡alÄ±ÅŸÄ±yor?</h1>

      <p id="howit-lead">
        KÄ±ble Bulucu, neredeysen orada KÃ¢beâ€™nin yÃ¶nÃ¼nÃ¼ bulmana yardÄ±m eden kÃ¼Ã§Ã¼k bir yol arkadaÅŸÄ±dÄ±r.
        Telefonunun konumunu alÄ±r, pusulayÄ± akÄ±llÄ±ca dÃ¼zeltir ve doÄŸru aÃ§Ä±yÄ± saniyeler iÃ§inde yÃ¼ksek doÄŸrulukla verir.
        Haritada bakman gereken yÃ¶nÃ¼ gÃ¶rÃ¼r, istersen kameranÄ±n Ã¼zerinde beliren okla adÄ±m adÄ±m yÃ¶nelirsin.
        TÃ¼m iÅŸlem cihazÄ±nda gerÃ§ekleÅŸir; gÃ¶rÃ¼ntÃ¼n ve konumun kimseyle paylaÅŸÄ±lmaz.
      </p>

      <ul id="howit-warnings" role="list" style="padding-left:0; margin: 12px 0 0 0;">
        <li>
          <span aria-hidden="true">âš ï¸</span>
          <span>DoÄŸru Ã§alÄ±ÅŸmasÄ± iÃ§in konum izni gerekir.</span>
        </li>
        <li>
          <span aria-hidden="true">âš ï¸</span>
          <span>Konum doÄŸruluÄŸu cihaz ve ortam koÅŸullarÄ±na baÄŸlÄ±dÄ±r.</span>
        </li>
        <li class="is-critical">
          <span aria-hidden="true">â—</span>
          <span>Uygulama geliÅŸtirme aÅŸamasÄ±ndadÄ±r.</span>
        </li>
      </ul>
    </div>

    <div id="howit-cta" class="welcome-social" style="margin-top:14px;">
      <button id="howit-tech" class="btn btn-secondary" type="button">Teknik Detaylar</button>
      <button id="howit-continue" class="btn btn-primary" type="button">Devam Et</button>
    </div>
  </section>
  <!-- ========== /HOW-IT-WORKS ========== -->

  <!-- ========== TEKNÄ°K DETAYLAR (YENÄ° EKRAN) ========== -->
  <section id="tech-screen" class="welcome" style="display:none;" aria-labelledby="tech-title">
    <!-- Ãœst bar: baÅŸlÄ±k ortalÄ±, saÄŸda kapat -->
    <div class="welcome-top">
      <!-- Sol dengeleyici (how-it back butonu boyutunda boÅŸluk) -->
      <div style="width:42px;height:42px;"></div>
      <h1 id="tech-title" class="title" style="margin:0;">Teknik Detaylar</h1>
      <button id="tech-close" class="theme-toggle" aria-label="Kapat" title="Kapat">
        <i class="fa-solid fa-xmark" aria-hidden="true"></i>
      </button>
    </div>

    <!-- YapÄ±ÅŸkan mini TOC -->
    <nav class="tech-toc" aria-label="Ä°Ã§indekiler">
      <button class="toc-chip is-active" data-target="#tech-scope">Kapsam</button>
      <button class="toc-chip" data-target="#tech-inputs">Veri</button>
      <button class="toc-chip" data-target="#tech-geodesy">WGS84</button>
      <button class="toc-chip" data-target="#tech-bearing">Azimut</button>
      <button class="toc-chip" data-target="#tech-declination">Sapma</button>
      <button class="toc-chip" data-target="#tech-heading">BaÅŸlÄ±k</button>
      <button class="toc-chip" data-target="#tech-filter-calib">Filtre/Kalibr.</button>
      <button class="toc-chip" data-target="#tech-accuracy">DoÄŸruluk</button>
      <button class="toc-chip" data-target="#tech-map">Harita</button>
      <button class="toc-chip" data-target="#tech-ar">AR</button>
      <button class="toc-chip" data-target="#tech-perf">Performans</button>
      <button class="toc-chip" data-target="#tech-privacy">Gizlilik</button>
      <button class="toc-chip" data-target="#tech-robust">SaÄŸlamlÄ±k</button>
    </nav>

    <!-- Ä°Ã§erik (tamamen aÃ§Ä±k; JS i18n ile doldurulacak) -->
    <div id="tech-content" class="tech-content">

      <article id="tech-scope" class="tech-card">
        <h2 data-i18n="tech.scope.title">Kapsam ve Hedef</h2>
        <div class="tech-body" data-i18n-html="tech.scope.html"></div>
      </article>

      <article id="tech-inputs" class="tech-card">
        <h2 data-i18n="tech.inputs.title">Veri Ã‡ekimi ve Ä°zinler</h2>
        <div class="tech-body" data-i18n-html="tech.inputs.html"></div>
      </article>

      <article id="tech-geodesy" class="tech-card">
        <h2 data-i18n="tech.geodesy.title">Jeodezik Model ve DÃ¶nÃ¼ÅŸÃ¼mler (WGS84)</h2>
        <div class="tech-body" data-i18n-html="tech.geodesy.html"></div>
      </article>

      <article id="tech-bearing" class="tech-card">
        <h2 data-i18n="tech.bearing.title">Azimut (Great-Circle) HesabÄ±</h2>
        <div class="tech-body" data-i18n-html="tech.bearing.html"></div>
      </article>

      <article id="tech-declination" class="tech-card">
        <h2 data-i18n="tech.declination.title">Manyetik Kuzey â†’ GerÃ§ek Kuzey (Declination)</h2>
        <div class="tech-body" data-i18n-html="tech.declination.html"></div>
      </article>

      <article id="tech-heading" class="tech-card">
        <h2 data-i18n="tech.heading.title">BaÅŸlÄ±k TÃ¼retimi ve Ekran YÃ¶nÃ¼ Telafisi</h2>
        <div class="tech-body" data-i18n-html="tech.heading.html"></div>
      </article>

      <article id="tech-filter-calib" class="tech-card">
        <h2 data-i18n="tech.filterCalib.title">Filtreleme ve Kalibrasyon</h2>
        <div class="tech-body" data-i18n-html="tech.filterCalib.html"></div>
      </article>

      <article id="tech-accuracy" class="tech-card">
        <h2 data-i18n="tech.accuracy.title">DoÄŸruluk ve GÃ¼ven PuanÄ±</h2>
        <div class="tech-body" data-i18n-html="tech.accuracy.html"></div>
      </article>

      <article id="tech-map" class="tech-card">
        <h2 data-i18n="tech.map.title">Harita Ã‡izimi</h2>
        <div class="tech-body" data-i18n-html="tech.map.html"></div>
      </article>

      <article id="tech-ar" class="tech-card">
        <h2 data-i18n="tech.ar.title">AR Boru HattÄ±</h2>
        <div class="tech-body" data-i18n-html="tech.ar.html"></div>
      </article>

      <article id="tech-perf" class="tech-card">
        <h2 data-i18n="tech.perf.title">Performans ve Enerji</h2>
        <div class="tech-body" data-i18n-html="tech.perf.html"></div>
      </article>

      <article id="tech-privacy" class="tech-card">
        <h2 data-i18n="tech.privacy.title">Gizlilik ve GÃ¼venlik</h2>
        <div class="tech-body" data-i18n-html="tech.privacy.html"></div>
      </article>

      <article id="tech-robust" class="tech-card">
        <h2 data-i18n="tech.robust.title">Hata DurumlarÄ± ve SaÄŸlamlÄ±k</h2>
        <div class="tech-body" data-i18n-html="tech.robust.html"></div>
      </article>

      <!-- Meta kart: GitHub + â€œAI ile yapÄ±lmÄ±ÅŸtÄ±râ€ -->
      <article id="tech-meta" class="tech-card tech-meta">
        <h2 class="visually-hidden">Proje ve KatkÄ±</h2>
        <div class="meta-row">
          <i class="fa-brands fa-github" aria-hidden="true"></i>
          <div>
            <div data-i18n="tech.meta.source">
              Kaynak kodu GitHubâ€™da yayÄ±nlanmÄ±ÅŸtÄ±r:
            </div>
            <a class="meta-link"
               href="https://github.com/bur4kkaplan/qibla-project"
               target="_blank" rel="noopener"
               aria-label="GitHub deposu: bur4kkaplan/qibla-project">
              https://github.com/bur4kkaplan/qibla-project
            </a>
          </div>
        </div>
        <div class="meta-row" style="margin-top:8px;">
          <i class="fa-solid fa-wand-magic-sparkles" aria-hidden="true"></i>
          <div data-i18n="tech.meta.ai">
            Bu uygulama yapay zekÃ¢ kullanÄ±larak geliÅŸtirilmiÅŸtir.
          </div>
        </div>
      </article>

    </div>
  </section>
  <!-- ========== /TEKNÄ°K DETAYLAR ========== -->

  <!-- ========== UYGULAMA AKIÅI (welcome sonrasÄ±) ========== -->
  <div class="card">
    <!-- Bilgilendirme -->
    <div id="info-screen" style="display:none;">
      <div class="title" id="info-title"></div>
      <p id="info-text"></p>
      <div class="center-buttons">
        <button class="btn btn-secondary" onclick="showDetails()" id="details-button"></button>
        <button class="btn btn-primary" id="confirm-button" onclick="startApp"></button>
      </div>
    </div>

    <!-- Eski â€œdetaylarâ€ ekranÄ± (mevcutta kullanÄ±lÄ±yor olabilir, kaldÄ±rmadÄ±m) -->
    <div id="details-screen" style="display:none;">
      <div class="top-right" onclick="hideDetails()">âŒ</div>
      <div class="title" id="details-title"></div>
      <div class="info" id="details-content"></div>
    </div>

    <!-- Ana uygulama -->
    <div id="main-app" style="display:none;">
      <p id="status"></p>

      <div id="output" style="display:none;">
        <p class="info" id="location"></p>
        <p class="info" id="accuracy"></p>
        <p class="info" id="error"></p>
        <p class="info" id="confidence"></p>
        <p class="qibla" id="qibla"></p>
      </div>

      <div id="map"></div>

      <div class="center-buttons" style="margin-top:1rem;">
        <button id="start-ar-btn" class="btn btn-secondary" style="display:none;">
          AR ile KÄ±bleyi GÃ¶ster
        </button>
      </div>
    </div>
  </div>

  <!-- Kalibrasyon ModalÄ± -->
  <div id="calibration-screen" class="modal hidden" aria-hidden="true">
    <div class="modal-content">
      <h2 id="calib-title">Kalibrasyon Gerekli</h2>
      <p id="calib-desc">
        LÃ¼tfen telefonunuzu <strong>yere paralel</strong> tutarak havada <strong>8</strong> Ã§izer gibi
        yavaÅŸÃ§a dÃ¶ndÃ¼rÃ¼n. Bu iÅŸlem pusula sensÃ¶rÃ¼nÃ¼ kalibre eder ve doÄŸruluÄŸu artÄ±rÄ±r.
      </p>

      <!-- ANDROID UYARISI (yalnÄ±z Androidâ€™de gÃ¶sterilecek) -->
      <div id="android-notice" class="notice hidden" role="status" aria-live="polite"></div>

      <div class="center-buttons">
        <button id="calibration-cancel-btn" class="btn">Ä°ptal</button>
        <button id="calibration-done-btn" class="btn btn-primary">Kalibrasyonu TamamladÄ±m</button>
      </div>
    </div>
  </div>

  <!-- AR tam ekran -->
  <div id="ar-container" class="hidden" aria-hidden="true">
    <video id="ar-video" autoplay playsinline muted></video>
    <div id="ar-overlay">
      <!-- Seccade (inline SVG, yerde) -->
      <svg id="ar-mat" viewBox="0 0 1000 1600" aria-label="Seccade">
        <rect x="20" y="20" width="960" height="1560" rx="26" fill="#0E7A57"/>
        <rect x="60" y="60" width="880" height="1480" rx="18"
              fill="none" stroke="#E7D48B" stroke-width="24"/>
        <path d="M220 480 Q 500 300 780 480 L 780 900 L 220 900 Z"
              fill="none" stroke="#E7D48B" stroke-width="18"/>
        <polygon points="500,1000 520,1050 575,1055 535,1090 545,1145 500,1118 455,1145 465,1090 425,1055 480,1050"
                 fill="#E7D48B" opacity="0.85"/>
      </svg>

      <!-- Merkez ok -->
      <div id="ar-arrow" class="arrow arrow-red" aria-label="KÄ±ble oku"></div>

      <!-- Ãœst bilgi ÅŸeridi (HUD) -->
      <div id="ar-hud">
        <span id="hud-heading">YÃ¶n: --Â°</span>
        <span id="hud-qibla">KÄ±ble: --Â°</span>
        <span id="hud-delta">Fark: --Â°</span>
      </div>

      <!-- Ã‡Ä±kÄ±ÅŸ -->
      <button id="ar-exit-btn" class="btn btn-primary ar-exit">Ã‡Ä±k</button>
    </div>
  </div>

</body>
</html>
